<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.boot.dao.BoardAttachDAO">

    <insert id="insertAttach" parameterType="com.boot.dto.BoardAttachDTO">
  INSERT INTO post_board_attach 
    (attach_no, board_no, file_name, file_path, uuid, is_image, thumb_path, sort_order)
  VALUES 
    (POST_BOARD_ATTACH_SEQ.NEXTVAL,
     #{boardNo,   jdbcType=NUMERIC},
     #{fileName,  jdbcType=VARCHAR},
     #{filePath,  jdbcType=VARCHAR},
     #{uuid,      jdbcType=VARCHAR},
     #{isImage,   jdbcType=CHAR},      <!-- 'Y' or 'N' -->
     #{thumbPath, jdbcType=VARCHAR},
     #{sortOrder, jdbcType=NUMERIC})
	</insert>

    <select id="findByBoardNo" resultType="com.boot.dto.BoardAttachDTO">
  SELECT 
      attach_no AS attachNo, 
      board_no AS boardNo, 
      file_name AS fileName, 
      file_path AS filePath, 
      uuid, 
      is_image AS isImage, 
      thumb_path AS thumbPath,
      sort_order AS sortOrder
  FROM post_board_attach
  WHERE board_no = #{boardNo}
  ORDER BY sort_order, attach_no
</select>
<!-- ✅ 단일 첨부 조회 -->
    <select id="findById" parameterType="long" resultType="com.boot.dto.BoardAttachDTO">
        SELECT 
            attach_no AS attachNo, 
            board_no AS boardNo, 
            file_name AS fileName, 
            file_path AS filePath, 
            uuid, 
            is_image AS isImage, 
            thumb_path AS thumbPath,
            sort_order AS sortOrder
        FROM post_board_attach
        WHERE attach_no = #{attachNo}
    </select>

    <!-- ✅ 단일 첨부 삭제 -->
    <delete id="delete" parameterType="long">
        DELETE FROM post_board_attach WHERE attach_no = #{attachNo}
    </delete>
</mapper>
